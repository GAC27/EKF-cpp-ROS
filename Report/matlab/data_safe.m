%% 72
clear all
state_1=[-2.00016 
    -10.0028 
    1.56911];
    
R=[0.1 0
   0 0.1];

% With R=diag(sigma_d^2,sigma_theta^2) <-- check slides
%   R=[  0.000225 0
%        0 7.6154*10^(-7)];

Q=[0.5 0 0
    0 0.5 0
    0 0 0.5];

cov_0= [0.1 0 0 
        0 0.1 0 
         0 0 0.1];

h_1=[1.075      1.025      0.975      0.975      0.925      0.975      0.975      0.975      0.975      0.925      0.975      0.975      0.975      0.975      0.975      1.025      1.025      1.075      1.125      1.175      1.225      1.275      1.325      1.425      1.525      1.675      1.825      2.025      2.225      2.575      2.525      2.475      2.425      2.375      2.375      2.375      2.325      2.375      4.225      4.275      4.325      4.375      4.475      2.625      2.625      2.775      2.875      3.025      3.175      3.325      3.525      3.775      3.775      3.625      3.475      3.375      3.275      3.175      3.125      3.125      3.025      3.075      3.075      3.075      3.075      3.075      3.075      3.125      3.175      3.275      3.325      3.425
 -0.520887  -0.462747  -0.404607  -0.346467  -0.288327  -0.230187  -0.172047  -0.113907 -0.0557668 0.00237322  0.0605132   0.118653   0.176793   0.234933   0.293073   0.351213   0.409353   0.467493   0.525633   0.583773   0.641913   0.700053   0.758193   0.816333   0.874473   0.932613   0.990753    1.04889    1.10703    1.16517    1.22331    1.28145    1.33959    1.39773    1.45587    1.51401    1.57215    1.63029    1.68843    1.74657    1.80471    1.86285    1.92099    1.97913    2.03727    2.09541    2.15355    2.21169    2.26983    2.32797    2.38611    2.44425    2.50239    2.56053    2.61867    2.67681    2.73495    2.79309    2.85123    2.90937    2.96751    3.02565    3.08379    3.14193    3.20007    3.25821    3.31635    3.37449    3.43263    3.49077    3.54891    3.60705];

z_1=[1.1416    1.10173     1.0611    1.06331    1.02826     1.0252    1.01111   0.997644    0.99396    1.00071     1.0012    1.00462   0.997551    1.03422    1.04956    1.05998    1.08563     1.0977     1.1394    1.18821    1.23201    1.29339    1.34879    1.46235    1.54971    1.65411    1.80308    2.00428    2.21657    2.52226    2.44232    2.42934    2.37592    2.34361    2.31756    2.31116    2.29634    2.29938    4.18881    4.21155    4.25981    4.33794     4.4274    4.52539    2.57715    2.64138    2.75928    2.88903    2.99036    3.18237    3.37921    3.59167    3.85384    3.83814    3.73407    3.61026    3.52694    3.41096    3.36503    3.30917    3.27749    3.24653    3.23563    3.23973     3.2264    3.25785    3.28531    3.30938    3.37138    3.44244     3.5016    3.60424
 -0.520887  -0.462747  -0.404607  -0.346467  -0.288327  -0.230187  -0.172047  -0.113907 -0.0557668 0.00237322  0.0605132   0.118653   0.176793   0.234933   0.293073   0.351213   0.409353   0.467493   0.525633   0.583773   0.641913   0.700053   0.758193   0.816333   0.874473   0.932613   0.990753    1.04889    1.10703    1.16517    1.22331    1.28145    1.33959    1.39773    1.45587    1.51401    1.57215    1.63029    1.68843    1.74657    1.80471    1.86285    1.92099    1.97913    2.03727    2.09541    2.15355    2.21169    2.26983    2.32797    2.38611    2.44425    2.50239    2.56053    2.61867    2.67681    2.73495    2.79309    2.85123    2.90937    2.96751    3.02565    3.08379    3.14193    3.20007    3.25821    3.31635    3.37449    3.43263    3.49077    3.54891    3.60705];

v_1_calc=z_1-h_1;

K_1=[-0.743467     -0.22782    -0.766997    -0.205581    -0.787935    -0.181984     -0.80621    -0.156983    -0.821761    -0.131628    -0.834535    -0.105476    -0.844488   -0.0791438    -0.851588   -0.0525442     -0.85581   -0.0257671     -0.85714   0.00109859    -0.855574    0.0279576    -0.851116    0.0547237    -0.843782    0.0813048    -0.833597     0.107611    -0.820595     0.133554    -0.804819     0.158437    -0.786324     0.183296    -0.765172     0.206304    -0.741434     0.227929     -0.71519     0.248066     -0.68653     0.266636     -0.65555     0.283588    -0.622354      0.29889    -0.587055      0.30819    -0.549772     0.315087    -0.510632     0.314827    -0.469766     0.312441    -0.427312     0.303492    -0.383414     0.293693    -0.338221     0.270848    -0.291885     0.281349    -0.244562      0.29118    -0.196413     0.300287      -0.1476     0.308614   -0.0982888     0.311228   -0.0486451      0.31279   0.00116304     0.318207    0.0509673      0.31274     0.100599     0.192241     0.149891     0.188568     0.198677     0.184339     0.246791      0.17958     0.294071      0.17253     0.340357      0.26653     0.385494     0.259379     0.429327     0.240564     0.471709      0.22554     0.512498     0.207672     0.551555     0.190455     0.588748     0.173874     0.623951     0.155962     0.657046     0.137539      0.68792     0.127767      0.71647     0.121844     0.742599     0.115021     0.766217     0.105869     0.787247    0.0958575     0.805617    0.0849657     0.821264    0.0721909     0.834135    0.0580302     0.844188    0.0448739     0.851388    0.0295652     0.855711     0.014764     0.857143 -8.70978e-05     0.855678   -0.0149378     0.851321   -0.0297381     0.844087    -0.044438     0.834001   -0.0581973     0.821096    -0.071396     0.805417   -0.0829165     0.787016   -0.0947747     0.765956    -0.104677
    0.426557    -0.397079     0.382635     -0.41209     0.337421    -0.424964     0.291066    -0.434821     0.243727    -0.443801     0.195565    -0.450097     0.146742    -0.455466    0.0974234    -0.459295    0.0477753    -0.461572  -0.00203419    -0.462909   -0.0518368    -0.461445    -0.101464     -0.45904    -0.150749    -0.455085    -0.199524    -0.449592    -0.247625    -0.442579    -0.294889    -0.432411    -0.341157    -0.422474    -0.386271    -0.408671    -0.430081    -0.392937    -0.472437     -0.37553    -0.513196    -0.356693    -0.552221    -0.336651    -0.589381    -0.315611    -0.624548    -0.289689    -0.657605    -0.263419     -0.68844    -0.233514    -0.716948    -0.204721    -0.743033    -0.174536    -0.766608    -0.146889    -0.787591    -0.116312    -0.805914    -0.101899    -0.821513   -0.0866837    -0.834336   -0.0706914    -0.844339   -0.0539495    -0.851489   -0.0359256    -0.855761   -0.0177803    -0.857142   0.00043177    -0.855626    0.0186291    -0.851219    0.0227196    -0.843935    0.0334915    -0.833799    0.0439241    -0.820846    0.0539915    -0.805119    0.0630169    -0.786671     0.115316    -0.765564     0.130608    -0.741871     0.139217     -0.71567     0.148657    -0.687051      0.15491    -0.656111     0.160105    -0.622953     0.164327     -0.58769     0.165585     -0.55044     0.164177    -0.511331     0.171892    -0.470494     0.185544    -0.428067     0.199534    -0.384193     0.211139    -0.339021     0.222592    -0.292704     0.233853    -0.245397     0.241599    -0.197261     0.245386    -0.148459     0.255169    -0.099154     0.253862   -0.0495148     0.255151  0.000292104     0.255578    0.0500977     0.255141    0.0997339     0.253842     0.149034     0.251685     0.197829     0.245346     0.245957     0.238347     0.293253      0.22773     0.339557     0.219666     0.384715     0.208409
           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0];
 
S_h1=[          0.7 -2.77556e-17
           0       1.2192
     0.7       0
      0 1.27109
         0.7 5.55112e-17
5.55112e-17     1.33116
          0.7 -2.77556e-17
           0      1.33116
          0.7 -2.77556e-17
           0      1.40124
          0.7            0
-2.77556e-17      1.33116
          0.7 -1.38778e-17
-1.38778e-17      1.33116
          0.7 -1.38778e-17
-1.38778e-17      1.33116
         0.7 6.93889e-18
          0     1.33116
         0.7 -2.1684e-19
          0     1.40124
          0.7 -6.93889e-18
          0      1.33116
         0.7 1.38778e-17
1.38778e-17     1.33116
         0.7 1.38778e-17
1.38778e-17     1.33116
          0.7            0
-2.77556e-17      1.33116
     0.7       0
      0 1.33116
          0.7 -2.77556e-17
           0      1.27109
         0.7           0
2.77556e-17     1.27109
          0.7 -2.77556e-17
 2.77556e-17       1.2192
          0.7 -2.77556e-17
           0      1.17407
         0.7 2.77556e-17
5.55112e-17     1.13459
     0.7       0
      0 1.09983
         0.7 2.77556e-17
          0     1.06909
     0.7       0
      0 1.04176
          0.7            0
-2.77556e-17     0.995476
          0.7 -2.77556e-17
-2.77556e-17     0.957995
          0.7            0
-2.77556e-17     0.913856
         0.7 2.77556e-17
2.77556e-17    0.880147
          0.7 -2.77556e-17
          0     0.846319
         0.7 1.38778e-17
1.38778e-17    0.821197
      0.7        0
       0 0.790489
      0.7        0
       0 0.794109
         0.7 1.38778e-17
1.38778e-17    0.797949
     0.7       0
      0 0.80203
      0.7        0
       0 0.806371
         0.7 1.04083e-17
3.46945e-18    0.806371
         0.7 1.73472e-18
          0    0.806371
          0.7 -5.42101e-20
           0     0.810996
      0.7        0
       0 0.806371
      0.7        0
       0 0.733612
          0.7 -3.46945e-18
-6.93889e-18     0.732831
          0.7            0
-6.93889e-18     0.732076
          0.7 -6.93889e-18
-1.38778e-17     0.731347
          0.7            0
-6.93889e-18     0.729962
      0.7        0
       0 0.787075
          0.7            0
-1.38778e-17     0.787075
          0.7            0
-1.38778e-17     0.777916
          0.7 -1.38778e-17
           0      0.77259
          0.7 -1.38778e-17
-1.38778e-17     0.765569
     0.7       0
      0 0.75952
         0.7 1.38778e-17
1.38778e-17    0.754271
      0.7        0
       0 0.748287
      0.7        0
     0 0.742103
      0.7        0
       0 0.742103
          0.7 -1.38778e-17
           0      0.74566
          0.7 -2.77556e-17
           0     0.749687
      0.7        0
       0 0.752675
      0.7        0
       0 0.755941
         0.7           0
1.38778e-17     0.75952
         0.7 6.93889e-18
6.93889e-18     0.76144
         0.7           0
6.93889e-18     0.76144
          0.7 -6.93889e-18
-6.93889e-18     0.765569
      0.7        0
       0 0.763454
         0.7           0
1.73472e-18    0.763454
          0.7 -1.35525e-20
-1.35525e-20     0.763454
          0.7            0
-1.73472e-18     0.763454
         0.7 3.46945e-18
          0    0.763454
          0.7 -6.93889e-18
-6.93889e-18     0.763454
          0.7 -6.93889e-18
           0      0.76144
         0.7           0
1.38778e-17     0.75952
      0.7        0
       0 0.755941
          0.7 -2.77556e-17
-1.38778e-17     0.754271
          0.7 -1.38778e-17
-1.38778e-17     0.751148];

S_1=zeros(144,144);

for i=1:2:size(S_h1,1);
    S_1(i,i)=S_h1(i,1);
    S_1(i,i+1)=S_h1(i,2);
    S_1(i+1,i)=S_h1(i+1,1);
    S_1(i+1,i+1)=S_h1(i+1,2);
end
 
 

v_1=[0.0665979
          0
  0.0767272
          0
  0.0860995
          0
  0.0883139
          0
   0.103256
          0
   0.050204
          0
  0.0361075
          0
  0.0226434
          0
  0.0189602
          0
  0.0757061
          0
  0.0262041
          0
  0.0296209
          0
  0.0225506
          0
  0.0592153
          0
  0.0745564
          0
  0.0349755
          0
  0.0606325
          0
  0.0226983
          0
  0.0143958
          0
  0.0132071
          0
 0.00701141
          0
  0.0183951
          0
  0.0237855
          0
  0.0373495
          0
  0.0247078
          0
 -0.0208876
          0
 -0.0219147
          0
 -0.0207167
          0
-0.00842953
          0
  -0.052736
          0
 -0.0826828
          0
 -0.0456617
          0
  -0.049077
          0
 -0.0313909
          0
 -0.0574412
          0
 -0.0638413
          0
 -0.0286562
          0
 -0.0756168
          0
 -0.0361853
          0
 -0.0634475
          0
 -0.0651932
          0
 -0.0370598
          0
 -0.0476022
          0
    1.90039
          0
 -0.0478494
          0
  -0.133618
          0
  -0.115722
          0
   -0.13597
          0
  -0.184638
          0
  -0.142631
          0
  -0.145789
          0
  -0.183326
          0
  0.0788386
          0
   0.213143
          0
   0.259076
          0
   0.235263
          0
   0.251947
          0
   0.235957
          0
   0.240034
          0
    0.18417
          0
   0.252491
          0
   0.171528
          0
   0.160629
          0
   0.164735
          0
   0.151398
          0
   0.182856
          0
   0.210307
          0
   0.184382
          0
   0.196387
          0
   0.167445
          0
   0.176599
          0
   0.179245
          0];

H_1=[-0.867378   0.49765         0
 -0.46293 -0.806863        -1
 -0.89483  0.446408         0
 -0.43552 -0.873005        -1
-0.919257  0.393657         0
-0.403751 -0.942828        -1
-0.940578  0.339577         0
-0.348284 -0.964696        -1
-0.958721  0.284348         0
-0.307404  -1.03645        -1
-0.973624  0.228159         0
 -0.23401 -0.998588        -1
-0.985236  0.171199         0
-0.175589   -1.0105        -1
 -0.99352  0.113661         0
-0.116575  -1.01899        -1
-0.998445 0.0557379         0
-0.057167  -1.02405        -1
  -0.999997 -0.00237322           0
 0.00256564    -1.08108          -1
  -0.99817 -0.0604763          0
 0.0620269   -1.02376         -1
-0.992969 -0.118375         0
  0.12141  -1.01843        -1
-0.984413 -0.175874         0
 0.180383  -1.00965        -1
 -0.97253 -0.232778         0
 0.238747 -0.997466        -1
-0.957361 -0.288896         0
 0.296303 -0.981908        -1
-0.938956 -0.344037         0
 0.335646 -0.916055        -1
-0.917378 -0.398016         0
 0.388308 -0.895003        -1
-0.892701  -0.45065         0
 0.419209 -0.830419        -1
-0.865006 -0.501761         0
  0.44601 -0.768895        -1
-0.834389 -0.551176         0
 0.469086 -0.710118        -1
-0.800952 -0.598729         0
 0.488758 -0.653838        -1
-0.764808 -0.644258         0
 0.505301 -0.599849        -1
 -0.72608 -0.687611         0
 0.518952 -0.547985        -1
-0.684898 -0.728639         0
 0.511326  -0.48063        -1
-0.641401 -0.767206         0
 0.503086 -0.420591        -1
-0.595737 -0.803179         0
  0.47951 -0.355664        -1
 -0.54806 -0.836439         0
 0.458323 -0.300307        -1
-0.498531 -0.866872         0
 0.428085 -0.246188        -1
-0.447317 -0.894376         0
 0.401967 -0.201041        -1
-0.394591 -0.918857         0
 0.356838 -0.153239        -1
-0.340532 -0.940233         0
  0.37237 -0.134864        -1
-0.285323 -0.958432         0
 0.387245 -0.115282        -1
 -0.229149  -0.973391          0
  0.401399 -0.0944944         -1
 -0.172201  -0.985062          0
  0.414763 -0.0725055         -1
  -0.11467  -0.993404          0
  0.418275 -0.0482822         -1
-0.0567526  -0.998388          0
  0.420374 -0.0238959         -1
 0.00135688   -0.999999           0
   0.430107 0.000583606          -1
0.0594618 -0.998231         0
 0.420308 0.0250366        -1
 0.117366 -0.993089         0
 0.235051 0.0277789        -1
 0.174873 -0.984591         0
 0.230314  0.040906        -1
 0.231789 -0.972766         0
 0.224917  0.053593        -1
 0.287923 -0.957654         0
 0.218892 0.0658109        -1
 0.343083 -0.939305         0
 0.209901 0.0766666        -1
 0.397084 -0.917782         0
 0.349632   0.15127        -1
 0.449743 -0.893158         0
 0.340251  0.171331        -1
 0.500881 -0.865516         0
 0.311898  0.180498        -1
 0.550328 -0.834949         0
 0.290417  0.191418        -1
0.597915 -0.80156        0
0.264979 0.197658       -1
 0.643481 -0.765462         0
 0.241091  0.202671        -1
 0.686873 -0.726778         0
  0.21858  0.206578        -1
 0.727943 -0.685638         0
 0.194507  0.206509        -1
0.766554 -0.64218        0
0.170114 0.203061       -1
 0.802574 -0.596553         0
 0.158027  0.212602        -1
0.835881 -0.54891        0
0.151424 0.230588       -1
 0.866365 -0.499411         0
 0.143716  0.249314        -1
  0.89392 -0.448226         0
 0.132808  0.264865        -1
 0.918455 -0.395525         0
 0.120771  0.280445        -1
 0.939886 -0.341488         0
 0.107555  0.296027        -1
 0.958141 -0.286297         0
 0.091615  0.306605        -1
 0.973158 -0.230138         0
0.0736442  0.311411        -1
 0.984886 -0.173202         0
0.0572568  0.325582        -1
 0.993287  -0.11568         0
0.0376194   0.32302        -1
   0.99833 -0.0577673          0
 0.0187861    0.32466         -1
           1  0.000340788            0
-0.000110825     0.325203           -1
   0.99829  0.0584473          0
-0.0190073   0.324648         -1
  0.993208   0.116356          0
-0.0378394   0.322995         -1
  0.984768   0.173872          0
-0.0565439    0.32025         -1
  0.973001   0.230801          0
-0.0738563   0.311361         -1
  0.957946   0.286949          0
-0.0903778   0.301715         -1
 0.939653  0.342128         0
-0.104467  0.286917        -1
 0.918186   0.39615         0
-0.119143  0.276146        -1
 0.893615  0.448834         0
-0.131047   0.26091        -1];

 h_1(1,44)=4.51;
 v_1_calc=z_1-h_1;
 v_1(87)=-v_1_calc(1,44);

save('data72.mat');

%% 10

clear all
state_1=[-2.00015 
    -10.0027 
    1.56888];
    
R=[0.1 0
   0 0.1];

% With R=diag(sigma_d^2,sigma_theta^2) <-- check slides
%   R=[  0.000225 0
%        0 7.6154*10^(-7)];

Q=[0.5 0 0
    0 0.5 0
    0 0 0.5];

cov_0= [0.1 0 0 
        0 0.1 0 
         0 0 0.1];

h_1=[1.075     0.975     1.025     1.275     2.375     2.375     4.475     3.475     3.225     3.075     3.425
-0.521115 -0.108321  0.304473  0.717267   1.13006   1.54286   1.95565   2.36844   2.78124   3.19403   3.60683];

z_1=[1.15817  0.984342   1.04927    1.3232   2.34264   2.30317   4.46757   3.27505   3.44887   3.23709   3.61737
-0.521115 -0.108321  0.304473  0.717267   1.13006   1.54286   1.95565   2.36844   2.78124   3.19403   3.60683];

v_1_calc=z_1-h_1;

K_1=[-0.74337    -0.22791   -0.852119   -0.049978   -0.817719     0.13806   -0.645947     0.28934   -0.365661    0.283356  -0.0239466    0.313172    0.321791    0.170243     0.61347    0.160848     0.80209   0.0865809    0.855965  -0.0133959    0.766043    -0.10463
   0.426726   -0.397027   0.0926652   -0.459581   -0.256963   -0.439342   -0.563424    -0.33172   -0.775233   -0.133653   -0.856808 -0.00875272   -0.794446    0.068957   -0.598623    0.164838   -0.302235    0.229774   0.0449266    0.255227     0.38454    0.208433
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0];
 
S_h1=[    0.7      0
     0 1.2192
         0.7           0
1.38778e-17     1.33116
         0.7           0
2.77556e-17     1.27109
        0.7 2.77556e-17
2.77556e-17     1.06909
          0.7 -1.38778e-17
-1.38778e-17     0.806371
          0.7  8.67362e-19
-8.67362e-19     0.806371
          0.7            0
-6.93889e-18     0.729962
     0.7        0
       0 0.749687
         0.7 6.93889e-18
6.93889e-18    0.757689
         0.7 1.73472e-18
1.73472e-18    0.763454
      0.7        0
       0 0.751148];

S_1=zeros(144,144);

for i=1:2:size(S_h1,1);
    S_1(i,i)=S_h1(i,1);
    S_1(i,i+1)=S_h1(i,2);
    S_1(i+1,i)=S_h1(i+1,1);
    S_1(i+1,i+1)=S_h1(i+1,2);
end
 
 

v_1=[0.0831711
          0
 0.00934196
          0
  0.0242698
          0
  0.0482023
          0
 -0.0323544
          0
 -0.0718281
          0
-0.00743151
          0
   -0.19995
          0
   0.223873
          0
   0.162093
          0
   0.192374
          0];

H_1=[-0.867265  0.497848         0
-0.463114 -0.806758        -1
-0.994139  0.108109         0
-0.110881  -1.01963        -1
-0.954005  -0.29979         0
 0.292478 -0.930737        -1
-0.753605 -0.657327         0
 0.515551 -0.591063        -1
-0.426605 -0.904438         0
 0.380816 -0.179623        -1
-0.0279377   -0.99961          0
  0.420888 -0.0117632         -1
 0.375422 -0.926854         0
 0.207118 0.0838933        -1
 0.715715 -0.698393         0
 0.200977  0.205961        -1
 0.935771 -0.352607         0
 0.109336  0.290162        -1
  0.998625  0.0524143          0
-0.0170453   0.324756         -1
 0.893717  0.448631         0
-0.130987   0.26094        -1];


v_1_calc=z_1-h_1;

save('data10.mat');